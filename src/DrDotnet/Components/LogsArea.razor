@using DrDotnet.Utils
@using System.Text
@namespace DrDotnet

<InputTextArea @bind-Value="@Logs" class="logs" style="height: 70vh; width: 85vw;" />

@code {
    
    [Parameter]
    public FileContentWatcher? FileWatcher { get; set; }

    private StringBuilder _logs = new();

    public string Logs {
        get { return _logs.ToString(); }
        set {}
    }
    
    protected override void OnInitialized()
    {
        FileWatcher!.ContentWritten += OnContentWritten;
        
        base.OnInitialized();
    }
    
    private void OnContentWritten(string content)
    {
        _logs.AppendLine(content);
        
        StateHasChanged();
    }
    
    public void Dispose()
    {
        FileWatcher!.ContentWritten -= OnContentWritten;
    }
}